name: Run Tests
on: [push]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses:  actions/setup-node@v3
        with:
          node-version: ${{ vars.NODE_VERSION }}
      - name: Install dependencies
        run: yarn
      - name: Run tests
        run: |
          git clone https://oauth2:$TOKEN_GITHUB@github.com/kalisio/development.git "development"
          source development/workspaces/libs/libs.sh feathers-webpush
          yarn test
        env:
          TOKEN_GITHUB: ${{ vars.TOKEN_GITHUB }}
  notify_slack:
    runs-on: ubuntu-latest
    needs: test
    steps:
    - name: Notify on Slack
      uses: rtCamp/action-slack-notify@v3
      with:
        slack-channel: your_slack_channel
        slack-color: ${{ job.status == 'success' && 'good' || 'danger' }}
        slack-text: |
          Build [#${{ github.run_number }}](https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }})
          (commit [${{ github.sha }}](https://github.com/${{ github.repository }}/commit/${{ github.sha }}))
          of ${{ github.repository }}@${{ github.ref }} by ${{ github.actor }} ${{
              job.status == 'success' && 'succeeded' || 'failed'
            }} in 
        